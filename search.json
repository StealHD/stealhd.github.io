[{"title":"Zerotier","path":"/2024/08/12/Zerotier/","content":"基于Zerotier根服务器的内网穿透部署创建（伪）根服务器项目地址：https://github.com/Jonnyan404/zerotier-planet 1docker run --restart=on-failure:3 -d --name ztncui -e HTTP_PORT=4000 -e HTTP_ALL_INTERFACES=yes -e ZTNCUI_PASSWD=mrdoc.fun -p 4000:4000 keynetworks/ztncui 创建 moon 服务器项目地址：https://github.com/jonnyan404/docker-zerotier-moon 12345#创建容器docker run --name zerotier-moon -d -p 9993:9993 -p 9993:9993/udp -v /etc/ztconf/:/var/lib/zerotier-one jonnyan404/zerotier-moon -4 [公网ipx.x.x.x]#查看moon IDdocker logs zerotier-moon 网络配置进入[IP]：4000 进入先改密码，默认密码 mrdoc.fun创建网段 下载Zerotire客户端加入自己id的网络，还需要授权 配置moon服务器12345#查看moon IDdocker logs zerotier-mooncd C:\\ProgramData\\ZeroTier\\Onezerotier-cli orbit [moon_id] [moon_id] 注：参考【https://gitee.com/spoto/natserver#windows-%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%8A%A0%E5%85%A5moon%E6%9C%8D%E5%8A%A1%E5%99%A8】","tags":["Zerotier"]},{"title":"Oracle data transform use dblink","path":"/2024/08/01/Oracle-Dblink/","content":"123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110-- Created on 7/23/2024-- 提前创建system.log日志表declare -- Local variables here i integer; new_owner varchar2(4000); new_table_name varchar2(4000);begin -- Test statements here for a in (select * from dba_users@dbsoar where username in (&#x27;###username&#x27;) order by username) loop for b in (select * from dba_tables@dbsoar where owner = a.username and table_name != &#x27;###table name&#x27; order by owner, table_name) loop for c in (select wm_concat(&#x27;&quot;&#x27; || column_name || &#x27;&quot;&#x27;) as column_name from dba_tab_cols@dbsoar where owner = b.owner and table_name = b.table_name and data_type not in (&#x27;BLOB&#x27;, &#x27;CLOB&#x27;, &#x27;LONG&#x27;, &#x27;LONG RAW&#x27;) and column_id is not null order by column_id) loop begin new_owner := &#x27;&quot;&#x27; || b.owner || &#x27;&quot;&#x27;; new_table_name := &#x27;&quot;&#x27; || b.table_name || &#x27;&quot;&#x27;; -- insert sql: create table insert into system.log values ((select nvl(max(id) + 1, 1) from system.log), sysdate, &#x27;info: sql: create table &#x27; || new_owner || &#x27;.&#x27; || new_table_name || &#x27; as select &#x27; || c.column_name || &#x27; from &#x27; || new_owner || &#x27;.&#x27; || new_table_name || &#x27;@dbsoar&#x27;); commit; -- select abs count table insert into system.log values ((select nvl(max(id) + 1, 1) from system.log), sysdate, &#x27;info: select abs count table: &#x27; || new_owner || &#x27;.&#x27; || new_table_name); commit; -- /*+ all_rows parallel (4) */ execute immediate &#x27;select /*+ all_rows parallel (4) */ abs((select count(*) from &#x27; || new_owner || &#x27;.&#x27; || new_table_name || &#x27;) - (select count(*) from &#x27; || new_owner || &#x27;.&#x27; || new_table_name || &#x27;@dbsoar)) from dual&#x27; into i; insert into system.log values ((select nvl(max(id) + 1, 1) from system.log), sysdate, &#x27;info: select abs count table: over: &#x27; || new_owner || &#x27;.&#x27; || new_table_name); commit; -- drop if gap &gt; 10000 and create table insert into system.log values ((select nvl(max(id) + 1, 1) from system.log), sysdate, &#x27;warn: &#x27; || i || &#x27;: &#x27; || new_owner || &#x27;.&#x27; || new_table_name); commit; if i &gt;= 10000 then execute immediate &#x27;drop /*+ all_rows parallel (4) */ table &#x27; || new_owner || &#x27;.&#x27; || new_table_name; execute immediate &#x27;create /*+ all_rows parallel (4) */ table &#x27; || new_owner || &#x27;.&#x27; || new_table_name || &#x27; as select &#x27; || c.column_name || &#x27; from &#x27; || new_owner || &#x27;.&#x27; || new_table_name || &#x27;@dbsoar&#x27;; insert into system.log values ((select nvl(max(id) + 1, 1) from system.log), sysdate, &#x27;warn: &#x27; || i || &#x27;: over: &#x27; || new_owner || &#x27;.&#x27; || new_table_name); commit; end if; exception when others then -- create table insert into system.log values ((select nvl(max(id) + 1, 1) from system.log), sysdate, &#x27;info: create table: &#x27; || new_owner || &#x27;.&#x27; || new_table_name); commit; execute immediate &#x27;create /*+ all_rows parallel (4) */ table &#x27; || new_owner || &#x27;.&#x27; || new_table_name || &#x27; as select &#x27; || c.column_name || &#x27; from &#x27; || new_owner || &#x27;.&#x27; || new_table_name || &#x27;@dbsoar&#x27;; insert into system.log values ((select nvl(max(id) + 1, 1) from system.log), sysdate, &#x27;info: create table: over: &#x27; || new_owner || &#x27;.&#x27; || new_table_name); commit; end; end loop; end loop; end loop;end;","tags":["Oracle"]},{"title":"Monitoring system installation","path":"/2024/05/23/Monitoring-system-installation/","content":"Monitoring system installation前置条件 oracle 服务器 + 监控服务器 说明：服务器监控由node_exporter实现，oracle自定义配置监控项（表空间+监听+ogg+dg+asm空间+process+session） 根据测试环境目前不考虑实现asm、dg、ogg的配置。 监控组件安装配置下载解压 官方网站：https://prometheus.io/download/ node_exporter-1.8.1.linux-amd64.tar.gzprometheus-2.45.5.linux-amd64.tar.gzalertmanager-0.27.0.linux-amd64.tar.gz sudo yum install -y https://dl.grafana.com/enterprise/release/grafana-enterprise-11.0.0-1.x86_64.rpmsudo systemctl start grafana-serversudo systemctl status grafana-server 1234567891011# 下载解压之后# 启动支持热重启curl -XPOST http://192.168.192.203:9090/-/reloadnohup ./prometheus --web.enable-lifecycle &amp;# 同理启动 node_exporter 添加自定义配置目录 --collector.textfile.directory=&quot;/root/node_exporter/prom/nohup ./node_exporter --collector.textfile.directory=&quot;/root/node_exporter/prom/&quot; &amp;# 启动 alertmanagernohup ./alertmanager &amp;# 安装grafanayum install -y https://dl.grafana.com/enterprise/release/grafana-enterprise-11.0.0-1.x86_64.rpmsystemctl start grafana-serversystemctl status grafana-server 配置oracle 端 node_exporter配置抓取信息sh脚本123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145# 同server端线先解压安装# 需要抓取的数据库信息 cat oracle.sh 生成的prom文件 /root/node_exporter/prom#!/bin/sh. /etc/profilecd /root/node_exporter/promexport LANG=en_US.UTF-8M=`date +%M`H=`date +%H`exec &gt; ../prom/oracle.prom 2&gt;/dev/null# tablespaceecho &quot;# TYPE tablespace_used_space gauge&quot;echo &quot;# TYPE tablespace_size gauge&quot;echo &quot;# TYPE tablespace_free_space gauge&quot;echo &quot;# TYPE tablespace_used_percent gauge&quot;su - oracle -c &quot;sqlplus -S / as sysdba&quot; &lt;&lt; EOF | grep -E -i &#x27;PERMANENT|TEMPORARY|UNDO&#x27; | \\awk &#x27;&#123; print &quot;tablespace_used_space&#123;tablespace=\\&quot;&quot; $1 &quot;\\&quot;,contents=\\&quot;&quot; $2 &quot;\\&quot;&#125; &quot; $3 &quot; &quot; \\ &quot;tablespace_size&#123;tablespace=\\&quot;&quot; $1 &quot;\\&quot;,contents=\\&quot;&quot; $2 &quot;\\&quot;&#125; &quot; $4 &quot; &quot; \\ &quot;tablespace_free_space&#123;tablespace=\\&quot;&quot; $1 &quot;\\&quot;,contents=\\&quot;&quot; $2 &quot;\\&quot;&#125; &quot; $5 &quot; &quot; \\ &quot;tablespace_used_percent&#123;tablespace=\\&quot;&quot; $1 &quot;\\&quot;,contents=\\&quot;&quot; $2 &quot;\\&quot;&#125; &quot; $6 &#125;&#x27;set line 200set pagesize 600select dt.tablespace_name, dt.contents, dt.block_size * dtum.used_space as used_space, dt.block_size * dtum.tablespace_size as tablespace_size, dt.block_size * (dtum.tablespace_size - dtum.used_space) as free_space, dtum.used_percent from dba_tablespace_usage_metrics dtum, dba_tablespaces dt where dtum.tablespace_name = dt.tablespace_name;exitEOF## tablespace# jobecho &quot;# TYPE job_broken gauge&quot;echo &quot;# TYPE job_running_time gauge&quot;echo &quot;# TYPE job_failures gauge&quot;su - oracle -c &quot;sqlplus -S / as sysdba&quot; &lt;&lt; EOF | grep -E &#x27;[0-9]&#x27; | grep -v &#x27;rows selected.&#x27; | \\awk &#x27;&#123; if ( $3 == &quot;N&quot; ) &#123; $3 = 1 &#125; if ( $3 == &quot;Y&quot; ) &#123; $3 = 0 &#125; \\print &quot;job_broken&#123;job=\\&quot;&quot; $1 &quot;\\&quot;,schema_user=\\&quot;&quot; $2 &quot;\\&quot;&#125; &quot; $3 &quot; &quot; \\ &quot;job_running_time&#123;job=\\&quot;&quot; $1 &quot;\\&quot;,schema_user=\\&quot;&quot; $2 &quot;\\&quot;&#125; &quot; $4 &quot; &quot; \\ &quot;job_failures&#123;job=\\&quot;&quot; $1 &quot;\\&quot;,schema_user=\\&quot;&quot; $2 &quot;\\&quot;&#125; &quot; $5 &#125;&#x27;set line 200set pagesize 600select a.job, a.schema_user, a.broken, nvl(sysdate - a.this_date, 0) * 24 * 60 * 60 running_time, nvl(a.failures, 0) failures from dba_jobs a;exitEOF## job# dgecho &quot;# TYPE dg_subtract_max_sequence gauge&quot;for mrp in `ps -ef | grep mrp | grep -v grep | awk &#x27;&#123; print $8 &#125;&#x27; | awk -F &#x27;_&#x27; &#x27;&#123; print $3 &#125;&#x27;`dosu - oracle -c &quot;export ORACLE_SID=$mrpsqlplus -S / as sysdba&quot; &lt;&lt; EOF | grep -E -i -v &#x27;INSTANCE_NAME|-&#x27; | \\awk &#x27;&#123; if ( ! NF ) &#123; next &#125; print &quot;dg_subtract_max_sequence&#123;instance_name=\\&quot;&quot; $1 &quot;\\&quot;,thread=\\&quot;&quot; $2 &quot;\\&quot;&#125; &quot; $5 &#125;&#x27;set line 200select instance_name, archived.thread#, archived.max_sequence# archived_max_sequence#, applied.max_sequence# applied_max_sequence#, archived.max_sequence# - applied.max_sequence# subtract_max_sequence# from v\\$instance, (select thread#, max(sequence#) max_sequence# from v\\$archived_log where archived = &#x27;YES&#x27; and resetlogs_change# = (select resetlogs_change# from v\\$database) group by thread#) archived, (select thread#, max(sequence#) max_sequence# from v\\$archived_log where applied = &#x27;YES&#x27; and resetlogs_change# = (select resetlogs_change# from v\\$database) group by thread#) applied where archived.thread# = applied.thread#;exitEOFdone## dg# processecho &quot;# TYPE oracle_max_process gauge&quot;su - oracle -c &quot;sqlplus -S / as sysdba&quot; &lt;&lt; EOF | grep -i -w &#x27;processes&#x27; | awk &#x27;&#123; print &quot;oracle_max_process &quot; $3 &#125;&#x27;show parameter processesexitEOFecho &quot;# TYPE oracle_cur_process gauge&quot;su - oracle -c &quot;sqlplus -S / as sysdba&quot; &lt;&lt; EOF | sed -n &#x27;4p&#x27; | column -t | awk &#x27;&#123; print &quot;oracle_cur_process &quot; $1 &#125;&#x27;select count(*) from v\\$process;exitEOFecho &quot;# TYPE oracle_nol_process gauge&quot;ps -ef | grep oracle | grep LOCAL=NO | wc -l | awk &#x27;&#123; print &quot;oracle_nol_process &quot; $1 &#125;&#x27;## process# sessionecho &quot;# TYPE oracle_max_session gauge&quot;su - oracle -c &quot;sqlplus -S / as sysdba&quot; &lt;&lt; EOF | grep -i -w &#x27;sessions&#x27; | awk &#x27;&#123; print &quot;oracle_max_session &quot; $3 &#125;&#x27;show parameter sessionsexitEOFecho &quot;# TYPE oracle_cur_session gauge&quot;su - oracle -c &quot;sqlplus -S / as sysdba&quot; &lt;&lt; EOF | sed -n &#x27;4p&#x27; | awk &#x27;&#123; print &quot;oracle_cur_session &quot; $1 &#125;&#x27;select count(*) from v\\$session;exitEOFecho &quot;# TYPE oracle_act_session gauge&quot;su - oracle -c &quot;sqlplus -S / as sysdba&quot; &lt;&lt; EOF | sed -n &#x27;4p&#x27; | awk &#x27;&#123; print &quot;oracle_act_session &quot; $1 &#125;&#x27;select count(*) from v\\$session where status = &#x27;ACTIVE&#x27;;exitEOF## session 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455# 文件内容[root@oracle prom]# cat oracle.prom# TYPE tablespace_used_space gauge# TYPE tablespace_size gauge# TYPE tablespace_free_space gauge# TYPE tablespace_used_percent gaugetablespace_used_space&#123;tablespace=&quot;OGG_DATA&quot;,contents=&quot;PERMANENT&quot;&#125; 9568256tablespace_size&#123;tablespace=&quot;OGG_DATA&quot;,contents=&quot;PERMANENT&quot;&#125; 1.9565E+10tablespace_free_space&#123;tablespace=&quot;OGG_DATA&quot;,contents=&quot;PERMANENT&quot;&#125; 1.9555E+10tablespace_used_percent&#123;tablespace=&quot;OGG_DATA&quot;,contents=&quot;PERMANENT&quot;&#125; .048904956tablespace_used_space&#123;tablespace=&quot;SYSAUX&quot;,contents=&quot;PERMANENT&quot;&#125; 906625024tablespace_size&#123;tablespace=&quot;SYSAUX&quot;,contents=&quot;PERMANENT&quot;&#125; 2.0309E+10tablespace_free_space&#123;tablespace=&quot;SYSAUX&quot;,contents=&quot;PERMANENT&quot;&#125; 1.9403E+10tablespace_used_percent&#123;tablespace=&quot;SYSAUX&quot;,contents=&quot;PERMANENT&quot;&#125; 4.46404586tablespace_used_space&#123;tablespace=&quot;SYSTEM&quot;,contents=&quot;PERMANENT&quot;&#125; 788004864tablespace_size&#123;tablespace=&quot;SYSTEM&quot;,contents=&quot;PERMANENT&quot;&#125; 2.0163E+10tablespace_free_space&#123;tablespace=&quot;SYSTEM&quot;,contents=&quot;PERMANENT&quot;&#125; 1.9375E+10tablespace_used_percent&#123;tablespace=&quot;SYSTEM&quot;,contents=&quot;PERMANENT&quot;&#125; 3.90823259tablespace_used_space&#123;tablespace=&quot;TEMP&quot;,contents=&quot;TEMPORARY&quot;&#125; 1048576tablespace_size&#123;tablespace=&quot;TEMP&quot;,contents=&quot;TEMPORARY&quot;&#125; 1.9387E+10tablespace_free_space&#123;tablespace=&quot;TEMP&quot;,contents=&quot;TEMPORARY&quot;&#125; 1.9386E+10tablespace_used_percent&#123;tablespace=&quot;TEMP&quot;,contents=&quot;TEMPORARY&quot;&#125; .005408644tablespace_used_space&#123;tablespace=&quot;UNDOTBS1&quot;,contents=&quot;UNDO&quot;&#125; 1310720tablespace_size&#123;tablespace=&quot;UNDOTBS1&quot;,contents=&quot;UNDO&quot;&#125; 1.9456E+10tablespace_free_space&#123;tablespace=&quot;UNDOTBS1&quot;,contents=&quot;UNDO&quot;&#125; 1.9455E+10tablespace_used_percent&#123;tablespace=&quot;UNDOTBS1&quot;,contents=&quot;UNDO&quot;&#125; .006736757tablespace_used_space&#123;tablespace=&quot;USERS&quot;,contents=&quot;PERMANENT&quot;&#125; 1572864tablespace_size&#123;tablespace=&quot;USERS&quot;,contents=&quot;PERMANENT&quot;&#125; 1.9361E+10tablespace_free_space&#123;tablespace=&quot;USERS&quot;,contents=&quot;PERMANENT&quot;&#125; 1.9359E+10tablespace_used_percent&#123;tablespace=&quot;USERS&quot;,contents=&quot;PERMANENT&quot;&#125; .008124075# TYPE job_broken gauge# TYPE job_running_time gauge# TYPE job_failures gaugejob_broken&#123;job=&quot;4001&quot;,schema_user=&quot;APEX_030200&quot;&#125; 1job_running_time&#123;job=&quot;4001&quot;,schema_user=&quot;APEX_030200&quot;&#125; 0job_failures&#123;job=&quot;4001&quot;,schema_user=&quot;APEX_030200&quot;&#125; 0job_broken&#123;job=&quot;4002&quot;,schema_user=&quot;APEX_030200&quot;&#125; 1job_running_time&#123;job=&quot;4002&quot;,schema_user=&quot;APEX_030200&quot;&#125; 0job_failures&#123;job=&quot;4002&quot;,schema_user=&quot;APEX_030200&quot;&#125; 0job_broken&#123;job=&quot;3&quot;,schema_user=&quot;SYSMAN&quot;&#125; 1job_running_time&#123;job=&quot;3&quot;,schema_user=&quot;SYSMAN&quot;&#125; 0job_failures&#123;job=&quot;3&quot;,schema_user=&quot;SYSMAN&quot;&#125; 0# TYPE dg_subtract_max_sequence gauge# TYPE oracle_max_process gaugeoracle_max_process 150# TYPE oracle_cur_process gaugeoracle_cur_process 33# TYPE oracle_nol_process gaugeoracle_nol_process 0# TYPE oracle_max_session gaugeoracle_max_session 249# TYPE oracle_cur_session gaugeoracle_cur_session 30# TYPE oracle_act_session gaugeoracle_act_session 29 编辑server端Prometheus配置文件123456789101112131415161718192021global: scrape_interval: external_labels: monitor: &#x27;codelab-monitor&#x27;alerting: alertmanagers: - static_configs: - targets: - 192.168.192.203:9093rule_files: - &quot;first_rules.yml&quot;scrape_configs: - job_name: &#x27;prometheus&#x27; scrape_interval: 5s static_configs: - targets: [&#x27;localhost:9090&#x27;] - job_name: &#x27;node_exporte&#x27; scrape_interval: 5s static_configs: - targets: [&#x27;localhost:9100&#x27;,&#x27;192.168.192.119:9100&#x27;] 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105# 借鉴配置形式 配置完热重启Prometheusgroups:- name: node_exporter rules: - alert: up expr: up&#123;job=&quot;node_exporter&quot;&#125; == 0 for: 1m annotations: description: &quot;&#123;&#123; $value &#125;&#125;&quot; - alert: filesystem expr: 100 - 100 * node_filesystem_avail_bytes&#123;fstype!~&quot;fuse.gvfs-fuse-daemon|fuse.gvfsd-fuse|rootfs|tmpfs&quot;,mountpoint!~&quot;/boot|/boot/efi&quot;&#125; / node_filesystem_size_bytes&#123;fstype!~&quot;fuse.gvfs-fuse-daemon|fuse.gvfsd-fuse|rootfs|tmpfs&quot;,mountpoint!~&quot;/boot|/boot/efi&quot;&#125; &gt;= 95 for: 1m annotations: description: &quot;&#123;&#123; $value &#125;&#125;&quot;- name: oracle rules: - alert: up expr: up&#123;instance=~&quot;172.16.10.101:9100|172.16.100.35:9100|172.16.100.36:9100|172.16.100.54:9100|172.16.100.55:9100|172.16.100.72:9100|172.16.100.73:9100|172.16.100.220:9100|192.168.18.200:9100&quot;&#125; == 0 for: 1m labels: service: oracle annotations: description: &quot;&#123;&#123; $value &#125;&#125;&quot; - alert: tcp_connect_oracle expr: probe_success&#123;job=&quot;blackbox_exporter_tcp_connect_oracle&quot;&#125; == 0 for: 1m labels: service: oracle annotations: description: &quot;&#123;&#123; $value &#125;&#125;&quot; - alert: tablespace expr: tablespace_used_percent&#123;contents=&quot;PERMANENT&quot;&#125; &gt;= 97.5 for: 1m labels: service: oracle annotations: description: &quot;&#123;&#123; $value &#125;&#125;&quot; - alert: ogg_up expr: ogg_up != 1 for: 1m labels: service: oracle annotations: description: &quot;&#123;&#123; $value &#125;&#125;&quot; - alert: ogg_lag_at_chkpt_seconds expr: ogg_lag_at_chkpt_seconds &gt;= 600 for: 1m labels: service: oracle annotations: description: &quot;&#123;&#123; $value &#125;&#125;&quot; - alert: ogg_time_since_chkpt_seconds expr: ogg_time_since_chkpt_seconds &gt;= 600 for: 1m labels: service: oracle annotations: description: &quot;&#123;&#123; $value &#125;&#125;&quot; - alert: asm expr: asm_lsdg_usable_file_mb&#123;name=~&quot;SOARHZDG/|SOARCADG/|DASJDATA/|DATA3/|DATA_DG02/&quot;&#125; / 1024 &lt;= 200 for: 1m labels: service: oracle annotations: description: &quot;&#123;&#123; $value &#125;&#125;&quot; - alert: dg_200 expr: dg_subtract_max_sequence&#123;instance_name=&quot;ZHXTDASJDG&quot;&#125; &gt;= 200 for: 1m labels: service: oracle annotations: description: &quot;&#123;&#123; $value &#125;&#125;&quot; - alert: dg_30 expr: dg_subtract_max_sequence&#123;instance_name!=&quot;ZHXTDASJDG&quot;&#125; &gt;= 30 for: 1m labels: service: oracle annotations: description: &quot;&#123;&#123; $value &#125;&#125;&quot; - alert: process expr: oracle_cur_process / oracle_max_process * 100 &gt;= 85 for: 1m labels: service: oracle annotations: description: &quot;&#123;&#123; $value &#125;&#125;&quot; - alert: session expr: oracle_cur_session / oracle_max_session * 100 &gt;= 85 for: 1m labels: service: oracle annotations: description: &quot;&#123;&#123; $value &#125;&#125;&quot; 还需要配置邮箱。 1234567891011121314151617181920212223242526272829303132333435363738global: smtp_from: &#x27;xx@qq.com&#x27; smtp_smarthost: &#x27;smtp.qq.com:465&#x27; smtp_auth_username: &#x27;xx@qq.com&#x27; smtp_auth_password: &#x27;xxx&#x27; smtp_require_tls: falseroute: group_by: [&#x27;alertname&#x27;] group_wait: 30s group_interval: 5m repeat_interval: 1h receiver: &#x27;email&#x27; routes: - receiver: &#x27;oracle&#x27; matchers: - service=oracle - receiver: &#x27;oa&#x27; matchers: - service=oareceivers: - name: &#x27;email&#x27; email_configs: - to: &#x27;xxx@gmail.com, xx@qq.com&#x27; send_resolved: true - name: &#x27;oracle&#x27; email_configs: - to: &#x27;xxx@gmail.com, xxx@qq.com, xxx@qq.com&#x27; send_resolved: true - name: &#x27;oa&#x27; email_configs: - to: &#x27;xxx@gmail.com, xxx@qq.com, xx@qq.com&#x27; send_resolved: trueinhibit_rules: - source_match: severity: &#x27;critical&#x27; target_match: severity: &#x27;warning&#x27; equal: [&#x27;alertname&#x27;, &#x27;dev&#x27;, &#x27;instance&#x27;]","tags":["Prometheus","Grafana"]},{"title":"Install Mysql8 base on Centos7","path":"/2024/05/22/Install-Mysql8-bash-on-Centos7/","content":"Install Mysql8 base on Centos7前置条件 下载 mysql 8 https://www.oracle.com/mysql/technologies/mysql-enterprise-edition-downloads.html Centos 7 安装mysql123456# 解压tar -xvf mysql-enterprise-8.4.0-javascript_el7_x86_64_bundle.tar# yum 安装yum install -y centos-release-scl yum install java-1.8.0-openjdk jpackage-utils rh-python38-pythonyum localinstall mysql* 1234567891011# 可能遇到报错** 发现 9 个已存在的 RPM 数据库问题， &#x27;yum check&#x27; 输出如下：icedtea-web-1.7.1-1.el7.x86_64 有缺少的需求 java-1.8.0-openjdkicedtea-web-1.7.1-1.el7.x86_64 有缺少的需求 jpackage-utilsicedtea-web-1.7.1-1.el7.x86_64 有缺少的需求 jpackage-utilsjline-1.0-8.el7.noarch 有缺少的需求 java &gt;= (&#x27;0&#x27;, &#x27;1.5&#x27;, None)jline-1.0-8.el7.noarch 有缺少的需求 jpackage-utilsrhino-1.7R5-1.el7.noarch 有缺少的需求 jpackage-utilsrhino-1.7R5-1.el7.noarch 有缺少的需求 jpackage-utilstagsoup-1.2.1-8.el7.noarch 有缺少的需求 jpackage-utilstagsoup-1.2.1-8.el7.noarch 有缺少的需求 jpackage-utils &gt;= (&#x27;0&#x27;, &#x27;1.6&#x27;, None) 12345678910111213141516171819[root@mysql mysql]# systemctl start mysqld[root@mysql mysql]# systemctl enable mysqld[root@mysql mysql]# systemctl status mysqld● mysqld.service - MySQL Server Loaded: loaded (/usr/lib/systemd/system/mysqld.service; enabled; vendor preset: disabled) Active: active (running) since 三 2024-05-22 14:50:45 CST; 14s ago Docs: man:mysqld(8) http://dev.mysql.com/doc/refman/en/using-systemd.html Main PID: 6058 (mysqld) Status: &quot;Server is operational&quot; CGroup: /system.slice/mysqld.service └─6058 /usr/sbin/mysqld5月 22 14:50:35 mysql systemd[1]: Starting MySQL Server...5月 22 14:50:45 mysql systemd[1]: Started MySQL Server.# 查看初始密码[root@mysql mysql]# grep &#x27;temporary password&#x27; /var/log/mysqld.log2024-05-22T06:50:43.504416Z 6 [Note] [MY-010454] [Server] A temporary password is generated for root@localhost: da9!&lt;k:j=L)9 123456789101112131415161718192021222324252627282930313233343536373839404142[root@mysql mysql]# mysql -uroot -pEnter password:Welcome to the MySQL monitor. Commands end with ; or \\g.Your MySQL connection id is 9Server version: 8.4.0-javascript-commercialCopyright (c) 2000, 2024, Oracle and/or its affiliates.Oracle is a registered trademark of Oracle Corporation and/or itsaffiliates. Other names may be trademarks of their respectiveowners.Type &#x27;help;&#x27; or &#x27;\\h&#x27; for help. Type &#x27;\\c&#x27; to clear the current input statement.# 修改密码mysql&gt; ALTER USER &#x27;root&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;F123mysql!&#x27;;Query OK, 0 rows affected (0.01 sec)# 修改密码策略mysql&gt; set global validate_password.length = 0;Query OK, 0 rows affected (0.00 sec)mysql&gt; set global validate_password.mixed_case_count = 0;Query OK, 0 rows affected (0.00 sec)mysql&gt; set global validate_password.number_count = 0;Query OK, 0 rows affected (0.00 sec)mysql&gt; set global validate_password.special_char_count = 0;Query OK, 0 rows affected (0.00 sec) mysql&gt; ALTER USER &#x27;root&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;mysql&#x27;;Query OK, 0 rows affected (0.00 sec)# 允许远程访问mysql&gt; update user set host=&#x27;%&#x27; where user =&#x27;root&#x27;;Query OK, 1 row affected (0.00 sec)Rows matched: 1 Changed: 1 Warnings: 0mysql&gt; FLUSH PRIVILEGES;Query OK, 0 rows affected (0.01 sec)mysql&gt;","tags":["Mysql"]},{"title":"DMDB8 install Base on Kylin","path":"/2024/05/17/DMDB-install-Base-on-Kylin/","content":"Installing DMDB8 base on Kylin环境准备 Kylin DMDB8 产品下载 | 达梦数据库 (dameng.com) DMDB安装系统环境配置注：官方很详细安装及卸载 | 达梦技术文档 (dameng.com) 12345678# 修改 dmdba 打开文件限制 其他具体可以参考官方文档echo &#x27;dmdba hard nofile 65536dmdba soft nofile 65536&#x27; &gt;&gt; /etc/security/limits.conf# 创建安装用户groupadd -g 12349 dinstalluseradd -u 12345 -g dinstall -m -d /home/dmdba -s /bin/bash dmdbapasswd dmdba# 输入密码 命令行安装安装1234567891011# 挂载iso mount -o loop dm8_20230712_FTarm_kylin10_sp1_64.iso /mnt &amp;&amp; cd /mnt cp DMInstall.bin /home/dmdba# 授权chown dmdba:dinstall /home/dmdba/DMInstall.binsu - dmdbamkdir temp# 指定临时空间 2G 够的可以不指定export DM_INSTALL_TMPDIR=/home/dmdba/temp#命令行安装cd &amp;&amp; ./DMInstall.bin -i 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485[dmdba@dmdb ~]$ ./DMInstall.bin -i安装语言: [1]: 简体中文[2]: English请选择安装语言 [1]:1解压安装程序......... 欢迎使用达梦数据库安装程序是否输入Key文件路径? (Y/y:是 N/n:否) [Y/y]:n是否设置时区? (Y/y:是 N/n:否) [Y/y]:y设置时区:[ 1]: (GTM-12:00) 日界线西[ 2]: (GTM-11:00) 萨摩亚群岛[ 3]: (GTM-10:00) 夏威夷[ 4]: (GTM-09:00) 阿拉斯加[ 5]: (GTM-08:00) 太平洋时间（美国和加拿大）[ 6]: (GTM-07:00) 亚利桑那[ 7]: (GTM-06:00) 中部时间（美国和加拿大）[ 8]: (GTM-05:00) 东部部时间（美国和加拿大）[ 9]: (GTM-04:00) 大西洋时间（美国和加拿大）[10]: (GTM-03:00) 巴西利亚[11]: (GTM-02:00) 中大西洋[12]: (GTM-01:00) 亚速尔群岛[13]: (GTM) 格林威治标准时间[14]: (GTM+01:00) 萨拉热窝[15]: (GTM+02:00) 开罗[16]: (GTM+03:00) 莫斯科[17]: (GTM+04:00) 阿布扎比[18]: (GTM+05:00) 伊斯兰堡[19]: (GTM+06:00) 达卡[20]: (GTM+07:00) 曼谷，河内[21]: (GTM+08:00) 中国标准时间[22]: (GTM+09:00) 首尔[23]: (GTM+10:00) 关岛[24]: (GTM+11:00) 所罗门群岛[25]: (GTM+12:00) 斐济[26]: (GTM+13:00) 努库阿勒法[27]: (GTM+14:00) 基里巴斯请选择时区 [21]:21安装类型:1 典型安装2 服务器3 客户端4 自定义请选择安装类型的数字序号 [1 典型安装]:1所需空间: 2310M请选择安装目录 [/home/dmdba/dmdbms]:可用空间: 26G是否确认安装路径(/home/dmdba/dmdbms)? (Y/y:是 N/n:否) [Y/y]:y安装前小结安装位置: /home/dmdba/dmdbms所需空间: 2310M可用空间: 26G版本信息: 有效日期: 安装类型: 典型安装是否确认安装? (Y/y:是 N/n:否):y2024-05-18 00:40:51 [INFO] 安装达梦数据库...2024-05-18 00:40:52 [INFO] 安装 基础 模块...2024-05-18 00:40:54 [INFO] 安装 服务器 模块...2024-05-18 00:40:55 [INFO] 安装 客户端 模块...2024-05-18 00:40:56 [INFO] 安装 驱动 模块...2024-05-18 00:40:56 [INFO] 安装 手册 模块...2024-05-18 00:40:56 [INFO] 安装 服务 模块...2024-05-18 00:40:57 [INFO] 移动日志文件。2024-05-18 00:40:57 [INFO] 安装达梦数据库完成。请以root系统用户执行命令:/home/dmdba/dmdbms/script/root/root_installer.sh安装结束 配置实例123456# root 创建文件目录mkdir -p /dmdata/datachown dmdba:dinstall /dmdatasu - dmdbacd /home/dmdba/dmdbms/bin./dminit path=/dmdata/data 123456789101112131415161718[dmdba@dmdb bin]$ ./dminit path=/dmdata/datainitdb V8db version: 0x7000cfile dm.key not found, use default license!License will expire on 2025-03-21Normal of FASTNormal of DEFAULTNormal of RECYCLENormal of KEEPNormal of ROLL log file path: /dmdata/data/DAMENG/DAMENG01.log log file path: /dmdata/data/DAMENG/DAMENG02.logwrite to dir [/dmdata/data/DAMENG].create dm database success. 2024-05-18 00:49:00 启动数据库 默认 账号密码 SYSDBA&#x2F;SYSDBA 12/home/dmdba/dmdbms/bin/DmServiceDMTEST start/home/dmdba/dmdbms/bin/DmServiceDMTEST status 123# 启动成功[dmdba@dmdb bin]$ /home/dmdba/dmdbms/bin/DmServiceDMTEST status DmServiceDMTEST (pid 6308) is running 进入数据库 12345678910/home/dmdba/dmdbms/bin/disql# 安装完成[dmdba@dmdb bin]$ /home/dmdba/dmdbms/bin/disqldisql V8用户名:SYSDBA密码:服务器[LOCALHOST:5236]:处于普通打开状态登录使用时间 : 3.155(ms)SQL&gt; 优化注册服务123cd /home/dmdba/dmdbms/script/root/# 注意自己路径 ./dm_service_installer.sh -t dmserver -dm_ini /dmdata/data/DAMENG/dm.ini -p DAMENG 环境变量1234su - dmdbavim .bash_profile# 添加$DM_HOME/binexport PATH=$PATH:$HOME/bin:$DM_HOME/bin","tags":["DMDB","Kylin"]},{"title":"Installing Oracle GoldenGate","path":"/2024/05/15/Installing-Oracle-GoldenGate/","content":"Installing Oracle GoldenGate 21需求：同步oracle（192.168.192.119源端）表hc.test 至oracle（192.168.192.119目标端）表hc.test ，采用集成模式，无ddl同步。 已安装oracle 11.2.0.4.0。 前置条件 Centos 7 Oracle11g数据库 数据库前置操作 开归档 12345678# 源端目标端都需要 需要重启数据库SQL&gt; archive log list;Database log mode Archive ModeAutomatic archival Enabled # 开启Archive destination USE_DB_RECOVERY_FILE_DESTOldest online log sequence 5Next log sequence to archive 7Current log sequence 7 开启附加日志&#x2F;开启复制参数&#x2F;配置STREAMS_POOL_SIZE 123456789101112131415161718192021# 源端目标端都需要SELECT supplemental_log_data_min, force_logging FROM v$database;# YES 为已经开启#SUPPLEME FOR#-------- ---#YES YESalter database add SUPPLEMENTAL LOG DATA;ALTER DATABASE FORCE LOGGING;# 开启复制参数alter system set enable_goldengate_replication=true;#sho parameter enable_goldengate_replication#NAME TYPE VALUE#------------------------------------ ----------- ------------------------------#enable_goldengate_replication boolean TRUE#配置STREAMS_POOL_SIZEALTER SYSTEM SET STREAMS_POOL_SIZE = 128M scope=both; 创建ogg用户授权 1234567891011121314151617181920212223242526272829303132333435363738394041#源端# 需要修改自己的路径create tablespace ogg_data datafile &#x27;/u01/app/oracle/oradata/orcl/ogg_data.dbf&#x27; size 200m autoextend on;create user oggadmin identified by oggadmin default tablespace ogg_data;GRANT CONNECT TO oggadmin;GRANT CREATE SESSION TO oggadmin;GRANT ALTER SESSION TO oggadmin;GRANT RESOURCE TO oggadmin;GRANT SELECT ANY DICTIONARY TO oggadmin;GRANT SELECT ANY TABLE TO oggadmin;GRANT FLASHBACK ANY TABLE TO oggadmin;GRANT ALTER ANY TABLE TO oggadmin;#同步测试表create user hc identified by hc;grant dba to hc;create table hc.test (id number(20),name varchar2(20));# 目标端create tablespace ogg_data datafile &#x27;/u01/app/oracle/oradata/orcl/ogg_data.dbf&#x27; size 200m autoextend on;create user oggadmin identified by oggadmin default tablespace ogg_data;GRANT ALTER SESSION TO oggadmin;GRANT CREATE SESSION TO oggadmin;GRANT CONNECT TO oggadmin;GRANT RESOURCE TO oggadmin;GRANT SELECT ANY DICTIONARY TO oggadmin;GRANT SELECT ANY TABLE TO oggadmin;GRANT FLASHBACK ANY TABLE TO oggadmin;GRANT INSERT ANY TABLE TO oggadmin;GRANT UPDATE ANY TABLE TO oggadmin;GRANT DELETE ANY TABLE TO oggadmin;#同步测试表create user hc identified by hc;grant dba to hc;create table hc.test (id number(20),name varchar2(20)); OGG-02912 处理 12345678910111213141516171819202122232425262728293031323334353637383940414243# ogg 安装目录cd /home/oracle/ogg[oracle@oracle2 ogg]$ sqlplus / as sysdbaSQL*Plus: Release 11.2.0.4.0 Production on Thu May 16 14:18:41 2024Copyright (c) 1982, 2013, Oracle. All rights reserved.Connected to:Oracle Database 11g Enterprise Edition Release 11.2.0.4.0 - 64bit ProductionWith the Partitioning, OLAP, Data Mining and Real Application Testing optionsSQL&gt; @prvtlmpg.plbOracle GoldenGate Workaround prvtlmpgThis script provides a temporary workaround for bug 17030189.It is strongly recommended that you apply the official OraclePatch for bug 17030189 from My Oracle Support instead of usingthis workaround.This script must be executed in the mining database of IntegratedCapture. You will be prompted for the username of the mining user.Use a double quoted identifier if the username is case sensitiveor contains special characters. In a CDB environment, this scriptmust be executed from the CDB$ROOT container and the mining usermust be a common user.=========================== WARNING ==========================You MUST stop all Integrated Captures that belong to this mininguser before proceeding!================================================================Enter Integrated Capture mining user: oggadminInstalling workaround...No errors.No errors.No errors.Installation completed.SQL&gt; 图形化安装ogg 21下载213000_fbo_ggs_Linux_x64_Oracle_shiphome.zip（https://www.oracle.com/middleware/technologies/goldengate-downloads.html# ） 注:数据库安装可以看 文章 centos 7 oracle11g install 解压ogg123456789101112# 创建ogg安装目录cd &amp;&amp; mkdir ogg &amp;&amp; cd# ogg在/home/oracle目录下 解压oggunzip unzip 213000_fbo_ggs_Linux_x64_Oracle_shiphome.zipcd fbo_ggs_Linux_x64_Oracle_shiphome/Disk1/# 192.168.192.1 是填写本机同网段ipDISPLAY=192.168.192.1:0.0; export DISPLAY# 处理中文乱码export LC_ALL=en_UScd fbo_ggs_Linux_x64_Oracle_shiphome/Disk1/# 图形化安装ogg./runInstaller 安装完成。 配置ogg123456789101112131415161718192021# 添加export TNS_ADMIN=$ORACLE_HOME/network/adminsu - oraclevim .bash_profile# 添加export TNS_ADMIN=$ORACLE_HOME/network/admin# ogg 安装目录cd /home/oracle/ogg &amp;&amp; ./ggsci# add credentialstore GGSCI（oracle，作为 oggadmin@orcl） 20&gt; add credentialstore GGSCI（oracle，作为 oggadmin@orcl） 20&gt; alter credentialstore add user oggadmin@192.168.192.119:1521/orcl, password oggadmin alias ggs GGSCI（oracle，作为 oggadmin@orcl） 20&gt; alter credentialstore add user oggadmin@192.168.192.200:1521/orcl, password oggadmin alias ggt# 验证info credentialstore GGSCI（oracle，作为 oggadmin@orcl） 20&gt; info credentialstore #GGSCI（oracle，作为 oggadmin@orcl） 10&gt; info credentialstore#正在从身份证明存储中读取：#默认域：OracleGoldenGate# 别名：ggs# 用户 ID：oggadmin@192.168.192.119:1521/orcl# 别名：ggt# 用户 ID：oggadmin@192.168.192.200:1521/orcl 配置mgr进程123456GGSCI（oracle，作为 oggadmin@orcl） 11&gt; EDIT params mgrPORT 7809AUTORESTART ER *,RETRIES 5,WAITMINUTES 1,RESETMINUTES 60PURGEOLDEXTRACTS ./dirdat/*,usecheckpoints, minkeepdays 15 配置源端抽取进程123456789101112131415161718192021222324252627282930# 添加附加日志 测试表GGSCI（oracle，作为 oggadmin@orcl） 13&gt; add trandata hc.testGGSCI（oracle，作为 oggadmin@orcl） 13&gt; EDIT params extEXTRACT extUSERIDALIAS ggsTRANLOGOPTIONS INTEGRATEDPARAMS (PARALLELISM 8)TRANLOGOPTIONS INTEGRATEDPARAMS (_LOGMINER_READ_BUFFERS 256)--TRANLOGOPTIONS INTEGRATEDPARAMS (max_sga_size 200, parallelism 1)STATOPTIONS REPORTFETCHLOGALLSUPCOLSNOCOMPRESSUPDATESUPDATERECORDFORMAT FULL--UPDATERECORDFORMAT COMPACTDBOPTIONS ALLOWUNUSEDCOLUMNTRANLOGOPTIONS EXCLUDEUSER oggadminFETCHOPTIONS NOUSESNAPSHOTEXTTRAIL ./dirdat/ie--DISCARDFILE ./dirrpt/ext1.dsc, PURGE, MEGABYTES 1024DISCARDFILE ./dirrpt/ext1.dsc, APPEND, MEGABYTES 1024WARNLONGTRANS 1H, CHECKINTERVAL 5MCACHEMGR CACHESIZE 1024MB, CACHEDIRECTORY ./dirtmptable hc.test;# 添加进程GGSCI（oracle，作为 oggadmin@orcl） 20&gt; ADD EXTRACT ext INTEGRATED TRANLOG BEGIN NOW GGSCI（oracle，作为 oggadmin@orcl） 20&gt; ADD EXTTRAIL ./dirdat/ie EXTRACT ext MEGABYTES 1024 #注册进程GGSCI（oracle，作为 oggadmin@orcl） 20&gt; REGISTER EXTRACT ext DATABASE 配置应用进程123456789101112131415161718192021222324252627282930313233343536GGSCI（oracle，作为 oggadmin@orcl） 20&gt; dblogin useridalias ggt#添加 checkpoint表GGSCI（oracle，作为 oggadmin@orcl） 20&gt; add checkpoint table oggadmin.ggs_checkpoint#配置 GLOBALSGGSCI（oracle，作为 oggadmin@orcl） 20&gt; EDIT PARAMS ./GLOBALScheckpointtable oggadmin.checkpointGGSCI（oracle，作为 oggadmin@orcl） 17&gt; edit params REPEXTREPLICAT repextUSERIDALIAS ggt--REPERROR (DEFAULT, ABEND)DISCARDFILE ./dirrpt/rep.dsc, PURGE, MEGABYTES 1024GETTRUNCATESALLOWNOOPUPDATESREPORTCOUNT EVERY 60 SECONDS, RATEREPORTROLLOVER AT 01:00DBOPTIONS ENABLE_INSTANTIATION_FILTERINGDBOPTIONS SUPPRESSTRIGGERS--DBOPTIONS DISABLECOMMITNOWAIT--MAP_PARALLELISM 4--MIN_APPLY_PARALLELISM 2--MAX_APPLY_PARALLELISM 10--SPLIT_TRANS_RECS 1000--DDL INCLUDE ALL--DDLOPTIONS REPORTMAP hc.test, TARGET hc.test;---添加进程 GGSCI（oracle，作为 oggadmin@orcl） 20&gt; ADD REPLICAT repext EXTTRAIL ./dirdat/ie checkpointtable oggadmin.checkpoint---注册进程 GGSCI（oracle，作为 oggadmin@orcl） 20&gt; dblogin useridalias ggt GGSCI（oracle，作为 oggadmin@orcl） 20&gt; register replicat repext database 测试测试说明：本地ogg仅配置抽取和应用。 12345678# 启动进程。GGSCI（oracle，作为 oggadmin@orcl） 20&gt; start *GGSCI（oracle，作为 oggadmin@orcl） 20&gt; info allMANAGER RUNNINGEXTRACT RUNNING EXT 00:00:06 00:00:06REPLICAT RUNNING REPEXT 00:00:00 00:00:03 插入数据 123insert into hc.test values(3,&#x27;c&#x27;);commit;select * from hc.test; 目标端查看 1select * from hc.test; 异构测试表异构说明： 源端表与目标端表字段异构。 采用抽取+pump+replicate三进程 1234567891011# 源端创建create table hc.test2 (id number(20),name varchar2(20),age number(10))#目标端 只同步 id 和 age 字段create table hc.test2 (id number(20),age number(10)) 配置抽取进程123456789101112131415161718192021# 源端配置# edit params ext_t2 EXTRACT ext_t2USERIDALIAS ggsTRANLOGOPTIONS INTEGRATEDPARAMS (PARALLELISM 8)TRANLOGOPTIONS INTEGRATEDPARAMS (_LOGMINER_READ_BUFFERS 256)--TRANLOGOPTIONS INTEGRATEDPARAMS (max_sga_size 200, parallelism 1)STATOPTIONS REPORTFETCHLOGALLSUPCOLSNOCOMPRESSUPDATESUPDATERECORDFORMAT FULL--UPDATERECORDFORMAT COMPACTDBOPTIONS ALLOWUNUSEDCOLUMNTRANLOGOPTIONS EXCLUDEUSER oggadminFETCHOPTIONS NOUSESNAPSHOTEXTTRAIL ./dirdat/te--DISCARDFILE ./dirrpt/ext1.dsc, PURGE, MEGABYTES 1024DISCARDFILE ./dirrpt/ext2.dsc, APPEND, MEGABYTES 1024WARNLONGTRANS 1H, CHECKINTERVAL 5MCACHEMGR CACHESIZE 1024MB, CACHEDIRECTORY ./dirtmptable hc.test2,cols (id,age); 123ADD EXTRACT ext_t2 INTEGRATED TRANLOG BEGIN NOW ADD EXTTRAIL ./dirdat/te EXTRACT ext_t2 MEGABYTES 1024 register extract ext_t2 database 配置推送进程1234567891011# 源端配置# edit param dp_t2 EXTRACT dp_t2 useridalias ggs DISCARDFILE ./dirrpt/dpet2.dsc, APPEND, MEGABYTES 1024 RMTHOST 192.168.192.200, MGRPORT 7809 RMTTRAIL ./dirdat/te--PASSTHRU sequence hc.*; table hc.test2; 12add extract dp_t2 EXTTRAILSOURCE ./dirdat/te add rmttrail ./dirdat/te extract dp_t2 MEGABYTES 1024 配置应用进程123456789101112131415161718# 目标端配置 edit param rep_extREPLICAT rep_ext USERIDALIAS ggt --REPERROR (DEFAULT, ABEND) DISCARDFILE ./dirrpt/dscte.dsc, PURGE, MEGABYTES 1024 discardrollover at 02:00 GETTRUNCATES ALLOWNOOPUPDATES REPORTCOUNT EVERY 60 SECONDS, RATE REPORTROLLOVER AT 01:00 DBOPTIONS ENABLE_INSTANTIATION_FILTERING DBOPTIONS SUPPRESSTRIGGERS --DBOPTIONS DISABLECOMMITNOWAIT --MAP_PARALLELISM 4 --MIN_APPLY_PARALLELISM 2 --MAX_APPLY_PARALLELISM 10 --SPLIT_TRANS_RECS 1000 MAP hc.test2, TARGET hc.test2; 123ADD REPLICAT rep_ext EXTTRAIL ./dirdat/te checkpointtable oggadmin.checkpoint dblogin useridalias ggt register replicat rep_ext database 测试1234# 源端insert into hc.test2 (id,age) values (1,10);commit;select* from hc.test2 12# 目标端查看select* from hc.test2 库异构注：oracle 同步至 MySQL 8.4 源端抽取进程12345678910111213141516171819202122GGSCI（oracle，作为 oggadmin@orcl） 88&gt; view params EXT_TSEXTRACT ext_tsUSERIDALIAS ggsTRANLOGOPTIONS INTEGRATEDPARAMS (PARALLELISM 8)TRANLOGOPTIONS INTEGRATEDPARAMS (_LOGMINER_READ_BUFFERS 256)--TRANLOGOPTIONS INTEGRATEDPARAMS (max_sga_size 200, parallelism 1)STATOPTIONS REPORTFETCHLOGALLSUPCOLSNOCOMPRESSUPDATESUPDATERECORDFORMAT FULL--UPDATERECORDFORMAT COMPACTDBOPTIONS ALLOWUNUSEDCOLUMNTRANLOGOPTIONS EXCLUDEUSER oggadminFETCHOPTIONS NOUSESNAPSHOTEXTTRAIL ./dirdat/ts--DISCARDFILE ./dirrpt/ext3.dsc, PURGE, MEGABYTES 1024DISCARDFILE ./dirrpt/ext3.dsc, APPEND, MEGABYTES 1024WARNLONGTRANS 1H, CHECKINTERVAL 5MCACHEMGR CACHESIZE 1024MB, CACHEDIRECTORY ./dirtmptable hc.test3; 源端推送进程1234567891011GGSCI（oracle，作为 oggadmin@orcl） 90&gt; view params DP_TSEXTRACT dp_tsuseridalias ggsDISCARDFILE ./dirrpt/dpet3.dsc, APPEND, MEGABYTES 1024RMTHOST 192.168.192.202, MGRPORT 7809RMTTRAIL ./dirdat/ts--PASSTHRUsequence hc.*;table hc.test3; 生成defgen文件12345678910111213141516171819202122# 源端生成defgen.prmGGSCI（oracle，作为 oggadmin@orcl） 91&gt; view params defgendefsfile ./dirdef/oracletomysql.def, purgeuseridalias ggsTABLE hc.test3;# 生成 su - oraclecd ogg./ggsci./defgen paramfile dirprm/defgen.prm# 将文件oracletomysql.def复制到目标端[root@mysql dirdef]# ll总用量 4-rw-r--r--. 1 root root 1286 5月 23 01:03 oracletomysql.def[root@mysql dirdef]# pwd/root/ogg/dirdef[root@mysql dirdef]# 目标端抽取进程配置123456789GGSCI (mysql) 2&gt; view params REP_TSREPLICAT rep_tssourcecharset ZHS16GBKtargetdb test useridalias ggm #需要加add credentialstoresourcedefs ./dirdef/oracletomysql.defdiscardfile ./dirdat/repts.dsc,appendMAP hc.test3, TARGET test.test3; 注：异构配置省略些许操作演示，其基本流程和表异构相差无几。 测试12345678910# 源端 闲杂数据是测试生成create table hc.test3 (id number(20),name varchar2(20),age number(10))insert into hc.test3 (id,name,age) values (11,&#x27;ff&#x27;,12);commit;select* from hc.test3 12#目标端查看select * from test.test3;","tags":["Oracle","Ogg"]},{"title":"centos 7 oracle11g install","path":"/2024/05/14/Oracle11g_install/","content":"Centos 7 Oracle 11g install准备所需文件 oracle 11g 文件 centos 7 iso （离线安装用） 补丁（可用可不用） 12345678910# 关闭 selinuxsudo sed -i &#x27;s/^SELINUX=enforcing$/SELINUX=permissive/&#x27; /etc/selinux/configsetenforce 0# 配置hosts echo &#x27;192.168.192.119 Oracle&#x27; &gt;&gt; /etc/hosts#离线安装 挂在iso 用于安装依赖 联网不用这步骤mount -o loop CentOS-7-x86_64-DVD-2009.iso /mnt/mv /etc/yum.repos.d/ /etc/yum.repos.d.bak/mkdir /etc/yum.repos.decho -e &quot;[iso] name=iso baseurl=file:///mnt/ gpgcheck=0 enabled=1&quot; | sudo tee /etc/yum.repos.d/iso.repo 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283# linux 7yum install -y binutils-*.x86_64 \\compat-libcap1-*.x86_64 \\compat-libstdc++-33-*.i686 \\compat-libstdc++-33-*.x86_64 \\gcc-*.x86_64 \\gcc-c++-*.x86_64 \\glibc-*.i686 \\glibc-*.x86_64 \\glibc-devel-*.i686 \\glibc-devel-*.x86_64 \\ksh \\libaio-*.i686 \\libaio-*.x86_64 \\libaio-devel-*.i686 \\libaio-devel-*.x86_64 \\libgcc-*.i686 \\libgcc-*.x86_64 \\libstdc++-*.i686 \\libstdc++-*.x86_64 \\libstdc++-devel-*.i686 \\libstdc++-devel-*.x86_64 \\libXi-*.i686 \\libXi-*.x86_64 \\libXtst-*.i686 \\libXtst-*.x86_64 \\make-*.x86_64 \\sysstat-*.x86_64 \\unixODBC-*.x86_64 \\unixODBC-*.i686 \\unixODBC-devel-*.x86_64 \\unixODBC-devel-*.i686 \\unzip# linux 6# yum install -y binutils compat-libcap1 compat-libstdc++-33 gcc gcc-c++ glibc glibc-devel ksh libgcc libstdc++ libstdc++-devel libaio libaio-devel make sysstat unixODBC-devel pdksh unziprm -rf /etc/yum.repo.d/mv /etc/yum.repos.d.bak/ /etc/yum.repos.d/# 配置oracle 用户 组groupadd oinstallgroupadd dbauseradd -g oinstall -G dba oracle# 配置资源 /etc/security/limits.confecho &#x27;oracle soft nofile 1024oracle hard nofile 65536oracle soft nproc 2047oracle hard nproc 16384oracle soft stack 10240oracle hard stack 32768&#x27; &gt;&gt; /etc/security/limits.confecho &#x27;kernel.sem = 250 32000 100 128kernel.shmall = 2097152kernel.shmmax = 536870912 # 单位B ,512M 根据自生内存修改 通常建议将其设置为系统内存的一半kernel.shmmni = 4096fs.file-max = 6815744fs.aio-max-nr = 1048576net.ipv4.ip_local_port_range = 9000 65500net.core.rmem_default = 262144net.core.rmem_max = 4194304net.core.wmem_default = 262144net.core.wmem_max = 1048576&#x27; &gt;&gt; /etc/sysctl.conf#配置生效sysctl -pmkdir -p /u01/app/chown -R oracle:oinstall /u01/app/chmod -R 775 /u01/app/unzip p13390677_112040_Linux-x86-64_1of7.zip -d /u01/unzip p13390677_112040_Linux-x86-64_2of7.zip -d /u01/chown -R oracle:oinstall /u01/databasechmod -R 775 /u01/databaseecho &#x27;export ORACLE_SID=orclexport ORACLE_BASE=/u01/app/oracleexport ORACLE_HOME=$ORACLE_BASE/product/11.2.0/dbhome_1export LD_LIBRARY_PATH=$ORACLE_HOME/lib:/lib:/usr/libexport PATH=$ORACLE_HOME/bin:$ORACLE_HOME/OPatch:$PATH&#x27; &gt;&gt; /home/oracle/.bash_profile 图形化安装oracle runInstaller123456su - oracle# 192.168.192.1 是填写本机同网段ipDISPLAY=192.168.192.1:0.0; export DISPLAY# 处理中文乱码export LC_ALL=en_US/u01/database/runInstaller 123456sed -i &#x27;s/^kernel.shmmax.*/kernel.shmmax = 1549053952/&#x27; /etc/sysctl.conf# test.conf# vim /etc/sysctl.conf# 修改完之后sysctl -p 1234567# oracle用户下sed -i &#x27;s/\\$(MK_EMAGENT_NMECTL)/\\$(MK_EMAGENT_NMECTL) -lnnz11/&#x27; /$ORACLE_HOME/sysman/lib/ins_emagent.mk#Exception String: Error in invoking target &#x27;agent nmhs&#x27; of makefile #&#x27;/u01/app/oracle/product/11.2.0/dbhome_1/sysman/lib/ins_emagent.mk&#x27;.#vi $ORACLE_HOME/sysman/lib/ins_emagent.mk |grep $(MK_EMAGENT_NMECTL)#$(MK_EMAGENT_NMECTL)#$(MK_EMAGENT_NMECTL) -lnnz11#Retry 123# root用户/u01/app/oraInventory/orainstRoot.sh/u01/app/oracle/product/11.2.0/dbhome_1/root.sh #敲个回车 1234567891011121314151617181920212223242526# 输出 [root@oracle ~]# /u01/app/oraInventory/orainstRoot.shChanging permissions of /u01/app/oraInventory.Adding read,write permissions for group.Removing read,write,execute permissions for world.Changing groupname of /u01/app/oraInventory to oinstall.The execution of the script is complete.[root@oracle ~]# /u01/app/oracle/product/11.2.0/dbhome_1/root.shPerforming root user operation for Oracle 11gThe following environment variables are set as: ORACLE_OWNER= oracle ORACLE_HOME= /u01/app/oracle/product/11.2.0/dbhome_1Enter the full pathname of the local bin directory: [/usr/local/bin]: Copying dbhome to /usr/local/bin ... Copying oraenv to /usr/local/bin ... Copying coraenv to /usr/local/bin ...Creating /etc/oratab file...Entries will be added to the /etc/oratab file as needed byDatabase Configuration Assistant when a database is createdFinished running generic part of root script.Now product-specific root actions will be performed.Finished product-specific root actions. netca12345# 监听安装netca#DISPLAY=192.168.192.1:0.0; export DISPLAY# 处理中文乱码#export LC_ALL=en_US 一路next，最后finish，可以根据需求修改监听。 dbca12345# 实例安装dbca#DISPLAY=192.168.192.1:0.0; export DISPLAY# 处理中文乱码#export LC_ALL=en_US 1# 实例id 看自己的bash_profile $ORACLE_SID 1# 显示不出 放大一下窗口 123456789101112131415161718192021222324# 测试实例sqlplus / as sysdbaselect open_mode from v$database;# 输出[oracle@oracle ~]$ sqlplus / as sysdbaSQL*Plus: Release 11.2.0.4.0 Production on Tue May 14 02:10:52 2024Copyright (c) 1982, 2013, Oracle. All rights reserved.Connected to:Oracle Database 11g Enterprise Edition Release 11.2.0.4.0 - 64bit ProductionWith the Partitioning, OLAP, Data Mining and Real Application Testing optionsSQL&gt;select open_mode from v$database;OPEN_MODE--------------------READ WRITESQL&gt;","tags":["Oracle"]},{"title":"hexo搭建部署","path":"/2024/05/08/hexo搭建/","content":"快速上手安装前所需环境介绍安装 Hexo 之前，需要确保您的 PC 中已经安装以下工具: Node.js [地址: Node.js — Run JavaScript Everywhere (nodejs.org)] Git [地址: Git (git-scm.com)] 安装hexo相关组件123456#安装完成后cnpm -v检查输出npm install -g cnpm --registry==https://registry.npm.taobao.org#安装完成后hexo -v检查输出cnpm install -g hexo-cli#之后更换主题有用npm install --save hexo-renderer-jade hexo-generator-feed hexo-generator-sitemap hexo-browsersync hexo-generator-archive 建议永远安装最新版本的 Hexo。 Hexo 版本 最低兼容 Node.js 版本 6.0+ 12.13.0 5.0+ 10.13.0 4.1 - 4.2 8.10 4.0 8.6 3.3 - 3.9 6.9 3.2 - 3.3 0.12 3.0 - 3.1 0.10 or iojs 0.0.1 - 2.8 0.10 选择合适文件夹下一键部署官方参考文档 文档 | Hexo 12345#初始化hexo init npm install#启动服务 http://localhost:4000/hexo server 后记：​ 这个只是简单的部署，还要考虑网站部署，参数修改，文章维护，主题优化等各个方面来健全自己的blog。 之后陆续跟新一下内容。","tags":["Hexo"]},{"title":"Hello World","path":"/2024/05/07/hello-world/","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot; More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment blockquote123&#123;% blockquote [author[, source]] [link] [source_link_title] %&#125;content&#123;% endblockquote %&#125; 123这是代码内容&#123;% endfolding %&#125; 图片代码块表格12let x = 123 print(&quot;hello world&quot;) a b c a1 b1 c1 a2 b2 c2 推荐的写法不推荐的写法123func test() &#123; // ... &#125; 123func test() -&gt; () &#123; // ... &#125; @tianhao_wang@eberhard@eberhard@eberhard@eberhard@vklemen 随记收藏随记 1 博客进阶：自动化部署本文讲了如何利用脚本和 GitHub Actions 简化博客搭建和部署流程，提高效率。 第一步：打开 GitHub打开 Stellar 的 GitHub 页面。第二步：点击 Star如果发现右上角的 Star 还没点亮，就点亮它！ Stellar Hexo GitHub Gitea 项目地址：https://gitee.com/link?target=https%3A%2F%2Fgithub.com%2FJonnyan404%2Fzerotier-planet"},{"title":"Pve","path":"/wiki/stellar/pve.html","content":"物理机信息： 8G内存 4核显 128g ssd 电源 12v 6A 注：根据一个月的测试上述资源够用。2024 618 前大概花费 1500（N100服务器 918 + 128ssd 75 + 4T 机械 420 + 电源70）。"}]